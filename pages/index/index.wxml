<!--pages/index/index.wxml-->
<view class="container">

  <!-- æ¬¢è¿åŒºåŸŸ -->
  <view class="welcome-section">
    <view class="user-info" wx:if="{{userInfo}}">
      <text class="welcome-text">æ¬¢è¿å›æ¥ï¼Œ{{userInfo.nickname || userInfo.username}}</text>
    </view>
    <view class="app-title">
      <text class="title">IEclub</text>
      <text class="subtitle">å…´è¶£äº¤æµç¤¾åŒº</text>
    </view>
  </view>

  <!-- å¿«é€ŸåŠŸèƒ½åŒº -->
  <view class="quick-actions">
    <view class="action-card ocr-card" bindtap="goToOCR">
      <view class="action-icon">
        <text class="iconfont icon-ocr">ğŸ“·</text>
      </view>
      <view class="action-info">
        <text class="action-title">OCRè¯†åˆ«</text>
        <text class="action-desc">å…è´¹è¯†åˆ«å›¾ç‰‡æ–‡å­—</text>
      </view>
    </view>

    <view class="action-card publish-card" bindtap="goToPublish">
      <view class="action-icon">
        <text class="iconfont icon-publish">âœï¸</text>
      </view>
      <view class="action-info">
        <text class="action-title">å‘å¸ƒå¸–å­</text>
        <text class="action-desc">åˆ†äº«ä½ çš„æƒ³æ³•</text>
      </view>
    </view>
  </view>

  <!-- å¸–å­åˆ—è¡¨ -->
  <view class="posts-section">
    <view class="section-header">
      <text class="section-title">æœ€æ–°å¸–å­</text>
      <navigator class="more-link" url="/pages/posts/posts">æŸ¥çœ‹æ›´å¤š</navigator>
    </view>

    <view class="posts-list">
      <view
        class="post-item"
        wx:for="{{posts}}"
        wx:key="id"
        bindtap="goToPost"
        data-id="{{item.id}}"
      >
        <view class="post-header">
          <view class="post-user">
            <image class="avatar" src="{{item.userAvatar}}" mode="aspectFill" />
            <text class="username">{{item.username}}</text>
          </view>
          <text class="post-time">{{item.createdAt}}</text>
        </view>

        <view class="post-content">
          <text class="post-text">{{item.content}}</text>
          <view class="post-images" wx:if="{{item.images && item.images.length > 0}}">
            <image
              class="post-image"
              src="{{item.images[0]}}"
              mode="aspectFill"
              bindtap="previewImage"
              data-current="{{item.images[0]}}"
              data-urls="{{item.images}}"
            />
          </view>
        </view>

        <view class="post-actions">
          <view class="action-item" bindtap="likePost" data-id="{{item.id}}" data-index="{{index}}">
            <text class="iconfont {{item.isLiked ? 'icon-liked' : 'icon-like'}}">
              {{item.isLiked ? 'â¤ï¸' : 'ğŸ¤'}}
            </text>
            <text class="action-count">{{item.likeCount}}</text>
          </view>
        </view>
      </view>

      <!-- åŠ è½½æ›´å¤š -->
      <view class="loading-more" wx:if="{{loading}}">
        <text>åŠ è½½ä¸­...</text>
      </view>

      <!-- æ²¡æœ‰æ›´å¤šå†…å®¹ -->
      <view class="no-more" wx:if="{{!hasMore && posts.length > 0}}">
        <text>æ²¡æœ‰æ›´å¤šå†…å®¹äº†</text>
      </view>
    </view>
  </view>

</view>