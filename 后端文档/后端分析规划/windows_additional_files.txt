# ==================== uploads/.gitkeep ====================
# æ­¤æ–‡ä»¶ç”¨äºä¿æŒ uploads ç›®å½•å­˜åœ¨
# Git ä¸ä¼šè¿½è¸ªç©ºç›®å½•ï¼Œæ‰€ä»¥éœ€è¦è¿™ä¸ªå ä½æ–‡ä»¶
# ä¸Šä¼ çš„æ–‡ä»¶ä¼šä¿å­˜åœ¨è¿™ä¸ªç›®å½•ä¸‹

# ç›®å½•è¯´æ˜ï¼š
# uploads/
#   â”œâ”€â”€ avatars/     - ç”¨æˆ·å¤´åƒ
#   â”œâ”€â”€ posts/       - å¸–å­å›¾ç‰‡
#   â”œâ”€â”€ events/      - æ´»åŠ¨å°é¢
#   â””â”€â”€ ocr/         - OCRè¯†åˆ«çš„å›¾ç‰‡


# ==================== logs/.gitkeep ====================
# æ­¤æ–‡ä»¶ç”¨äºä¿æŒ logs ç›®å½•å­˜åœ¨
# æ—¥å¿—æ–‡ä»¶ä¼šä¿å­˜åœ¨è¿™ä¸ªç›®å½•ä¸‹

# æ—¥å¿—æ–‡ä»¶ï¼š
# logs/
#   â”œâ”€â”€ combined.log  - æ‰€æœ‰æ—¥å¿—
#   â”œâ”€â”€ error.log     - é”™è¯¯æ—¥å¿—
#   â”œâ”€â”€ pm2-error.log - PM2é”™è¯¯æ—¥å¿—
#   â””â”€â”€ pm2-out.log   - PM2è¾“å‡ºæ—¥å¿—


# ==================== tests/.gitkeep ====================
# æ­¤æ–‡ä»¶ç”¨äºä¿æŒ tests ç›®å½•å­˜åœ¨
# æµ‹è¯•æ–‡ä»¶ä¼šä¿å­˜åœ¨è¿™ä¸ªç›®å½•ä¸‹

# æµ‹è¯•ç›®å½•ç»“æ„ï¼š
# tests/
#   â”œâ”€â”€ unit/         - å•å…ƒæµ‹è¯•
#   â”œâ”€â”€ integration/  - é›†æˆæµ‹è¯•
#   â””â”€â”€ e2e/          - ç«¯åˆ°ç«¯æµ‹è¯•


# ==================== Windowsæ‰¹å¤„ç†æ–‡ä»¶ä¼˜åŒ–ç‰ˆ ====================

# ========== create-gitkeep.bat ==========
@echo off
echo åˆ›å»º .gitkeep æ–‡ä»¶...

REM åˆ›å»ºå ä½æ–‡ä»¶
type nul > uploads\.gitkeep
type nul > logs\.gitkeep  
type nul > tests\.gitkeep

echo .gitkeep æ–‡ä»¶åˆ›å»ºå®Œæˆï¼
pause


# ========== quick-install.bat ==========
@echo off
chcp 65001 >nul
color 0A

echo.
echo ========================================
echo ğŸš€ IEclub å¿«é€Ÿå®‰è£…ï¼ˆWindowsï¼‰
echo ========================================
echo.

REM æ£€æŸ¥Node.js
where node >nul 2>nul
if %ERRORLEVEL% NEQ 0 (
    color 0C
    echo âŒ æœªå®‰è£… Node.js
    echo.
    echo è¯·å…ˆå®‰è£… Node.js:
    echo https://nodejs.org
    pause
    exit /b 1
)

echo âœ… Node.js å·²å®‰è£…
echo.

REM å®‰è£…ä¾èµ–
echo ğŸ“¦ æ­£åœ¨å®‰è£…ä¾èµ–...
echo.
call npm install

if %ERRORLEVEL% EQU 0 (
    echo.
    echo âœ… ä¾èµ–å®‰è£…æˆåŠŸï¼
    echo.
    echo ğŸ“‹ ä¸‹ä¸€æ­¥ï¼š
    echo   1. å¤åˆ¶ .env.example ä¸º .env
    echo   2. ç¼–è¾‘ .env é…ç½®æ•°æ®åº“å¯†ç 
    echo   3. è¿è¡Œ start-dev.bat å¯åŠ¨æœåŠ¡å™¨
    echo.
) else (
    color 0C
    echo âŒ ä¾èµ–å®‰è£…å¤±è´¥
    echo.
)

pause


# ========== check-env.bat ==========
@echo off
chcp 65001 >nul

echo.
echo ========================================
echo ğŸ” æ£€æŸ¥å¼€å‘ç¯å¢ƒ
echo ========================================
echo.

REM æ£€æŸ¥Node.js
echo æ£€æŸ¥ Node.js...
where node >nul 2>nul
if %ERRORLEVEL% EQU 0 (
    for /f "tokens=*" %%i in ('node -v') do set NODE_VERSION=%%i
    echo âœ… Node.js: %NODE_VERSION%
) else (
    echo âŒ Node.js æœªå®‰è£…
)
echo.

REM æ£€æŸ¥npm
echo æ£€æŸ¥ npm...
where npm >nul 2>nul
if %ERRORLEVEL% EQU 0 (
    for /f "tokens=*" %%i in ('npm -v') do set NPM_VERSION=%%i
    echo âœ… npm: %NPM_VERSION%
) else (
    echo âŒ npm æœªå®‰è£…
)
echo.

REM æ£€æŸ¥PostgreSQL
echo æ£€æŸ¥ PostgreSQL...
where psql >nul 2>nul
if %ERRORLEVEL% EQU 0 (
    echo âœ… PostgreSQL å·²å®‰è£…
) else (
    echo âš ï¸  PostgreSQL æœªå®‰è£…æˆ–æœªæ·»åŠ åˆ°PATH
    echo.
    echo è§£å†³æ–¹æ³•ï¼š
    echo 1. å®‰è£… PostgreSQL: https://www.postgresql.org/download/windows/
    echo 2. æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ï¼š
    echo    C:\Program Files\PostgreSQL\14\bin
)
echo.

REM æ£€æŸ¥Git
echo æ£€æŸ¥ Git...
where git >nul 2>nul
if %ERRORLEVEL% EQU 0 (
    for /f "tokens=*" %%i in ('git --version') do set GIT_VERSION=%%i
    echo âœ… Git: %GIT_VERSION%
) else (
    echo âš ï¸  Git æœªå®‰è£…ï¼ˆå¯é€‰ï¼‰
)
echo.

REM æ£€æŸ¥é¡¹ç›®æ–‡ä»¶
echo æ£€æŸ¥é¡¹ç›®æ–‡ä»¶...
if exist "package.json" (
    echo âœ… package.json
) else (
    echo âŒ package.json ç¼ºå¤±
)

if exist ".env" (
    echo âœ… .env
) else (
    echo âš ï¸  .env æœªé…ç½®
    echo    è¯·å¤åˆ¶ .env.example ä¸º .env
)

if exist "src\server.js" (
    echo âœ… src\server.js
) else (
    echo âŒ src\server.js ç¼ºå¤±
)

if exist "node_modules" (
    echo âœ… node_modules
) else (
    echo âš ï¸  node_modules ç¼ºå¤±
    echo    è¯·è¿è¡Œ: npm install
)
echo.

echo ========================================
echo æ£€æŸ¥å®Œæˆï¼
echo ========================================
pause


# ========== create-database.bat ==========
@echo off
chcp 65001 >nul

echo.
echo ========================================
echo ğŸ—„ï¸  åˆ›å»ºæ•°æ®åº“
echo ========================================
echo.

set /p DB_PASSWORD="è¯·è¾“å…¥ PostgreSQL å¯†ç : "

echo.
echo æ­£åœ¨åˆ›å»ºæ•°æ®åº“ ieclub_dev...
echo.

REM è®¾ç½®å¯†ç ç¯å¢ƒå˜é‡
set PGPASSWORD=%DB_PASSWORD%

REM åˆ›å»ºæ•°æ®åº“
psql -U postgres -h localhost -c "CREATE DATABASE ieclub_dev;" 2>nul

if %ERRORLEVEL% EQU 0 (
    echo âœ… æ•°æ®åº“åˆ›å»ºæˆåŠŸï¼
) else (
    echo âš ï¸  æ•°æ®åº“å¯èƒ½å·²å­˜åœ¨æˆ–åˆ›å»ºå¤±è´¥
    echo.
    echo æ‰‹åŠ¨åˆ›å»ºæ–¹æ³•ï¼š
    echo   1. æ‰“å¼€å‘½ä»¤è¡Œ
    echo   2. è¾“å…¥: psql -U postgres
    echo   3. è¾“å…¥å¯†ç 
    echo   4. æ‰§è¡Œ: CREATE DATABASE ieclub_dev;
    echo   5. é€€å‡º: \q
)

echo.
pause


# ========== reset-project.bat ==========
@echo off
chcp 65001 >nul

echo.
echo ========================================
echo âš ï¸  é‡ç½®é¡¹ç›®
echo ========================================
echo.
echo è¿™å°†åˆ é™¤ï¼š
echo   - node_modules
echo   - package-lock.json
echo   - logs ç›®å½•ä¸‹çš„æ—¥å¿—
echo.

set /p CONFIRM="ç¡®å®šè¦é‡ç½®å—? (y/N): "

if /i "%CONFIRM%"=="y" (
    echo.
    echo æ­£åœ¨é‡ç½®é¡¹ç›®...
    
    if exist "node_modules" (
        echo åˆ é™¤ node_modules...
        rmdir /s /q node_modules
    )
    
    if exist "package-lock.json" (
        echo åˆ é™¤ package-lock.json...
        del /q package-lock.json
    )
    
    if exist "logs" (
        echo æ¸…ç†æ—¥å¿—æ–‡ä»¶...
        del /q logs\*.log 2>nul
    )
    
    echo.
    echo âœ… é‡ç½®å®Œæˆï¼
    echo.
    echo ä¸‹ä¸€æ­¥ï¼š
    echo   1. è¿è¡Œ: npm install
    echo   2. è¿è¡Œ: start-dev.bat
    echo.
) else (
    echo æ“ä½œå·²å–æ¶ˆ
)

pause


# ========== view-logs.bat ==========
@echo off
chcp 65001 >nul

echo.
echo ========================================
echo ğŸ“‹ æŸ¥çœ‹æ—¥å¿—
echo ========================================
echo.
echo 1. æŸ¥çœ‹æœ€æ–°é”™è¯¯æ—¥å¿—
echo 2. æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
echo 3. æ¸…ç©ºæ—¥å¿—
echo 4. é€€å‡º
echo.

set /p CHOICE="è¯·é€‰æ‹© (1-4): "

if "%CHOICE%"=="1" (
    if exist "logs\error.log" (
        echo.
        echo ===== é”™è¯¯æ—¥å¿— =====
        type logs\error.log | more
    ) else (
        echo é”™è¯¯æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨
    )
    pause
    goto :eof
)

if "%CHOICE%"=="2" (
    if exist "logs\combined.log" (
        echo.
        echo ===== æ‰€æœ‰æ—¥å¿— =====
        type logs\combined.log | more
    ) else (
        echo æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨
    )
    pause
    goto :eof
)

if "%CHOICE%"=="3" (
    echo.
    set /p CONFIRM="ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ—¥å¿—å—? (y/N): "
    if /i "%CONFIRM%"=="y" (
        del /q logs\*.log 2>nul
        echo âœ… æ—¥å¿—å·²æ¸…ç©º
    ) else (
        echo æ“ä½œå·²å–æ¶ˆ
    )
    pause
    goto :eof
)

echo é€€å‡º
pause


# ========== README-Windows.md ==========
# Windows å¼€å‘æŒ‡å—

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒæ£€æŸ¥
```bash
# åŒå‡»è¿è¡Œ
check-env.bat
```

### 2. åˆ›å»ºæ•°æ®åº“
```bash
# åŒå‡»è¿è¡Œ
create-database.bat
```

### 3. å®‰è£…ä¾èµ–
```bash
# åŒå‡»è¿è¡Œ
quick-install.bat
```

### 4. å¯åŠ¨é¡¹ç›®
```bash
# åŒå‡»è¿è¡Œ
start-dev.bat
```

## å¸¸ç”¨å‘½ä»¤

### npm å‘½ä»¤
```bash
npm install          # å®‰è£…ä¾èµ–
npm run dev          # å¼€å‘æ¨¡å¼
npm start            # ç”Ÿäº§æ¨¡å¼
npm test             # è¿è¡Œæµ‹è¯•
npm run lint         # ä»£ç æ£€æŸ¥
```

### æ•°æ®åº“å‘½ä»¤
```bash
# è¿æ¥æ•°æ®åº“
psql -U postgres

# åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“
\l

# è¿æ¥åˆ°æ•°æ®åº“
\c ieclub_dev

# åˆ—å‡ºæ‰€æœ‰è¡¨
\dt

# é€€å‡º
\q
```

### Git å‘½ä»¤
```bash
git status           # æŸ¥çœ‹çŠ¶æ€
git add .            # æ·»åŠ æ‰€æœ‰æ–‡ä»¶
git commit -m "msg"  # æäº¤
git push             # æ¨é€
git pull             # æ‹‰å–
```

## Windows ç‰¹æ®Šè¯´æ˜

### è·¯å¾„åˆ†éš”ç¬¦
- Windows: åæ–œæ  `\`
- ç¤ºä¾‹: `src\controllers\userController.js`

### ç¯å¢ƒå˜é‡
- æ‰“å¼€æ–¹å¼: 
  - Win + R â†’ sysdm.cpl â†’ é«˜çº§ â†’ ç¯å¢ƒå˜é‡
  - æˆ–æœç´¢"ç¯å¢ƒå˜é‡"

### PostgreSQL é…ç½®
- å®‰è£…è·¯å¾„: `C:\Program Files\PostgreSQL\14`
- æ·»åŠ åˆ° PATH: `C:\Program Files\PostgreSQL\14\bin`
- æœåŠ¡ç®¡ç†: services.msc

### ç«¯å£æ£€æŸ¥
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -ano | findstr :5000

# ç»“æŸè¿›ç¨‹
taskkill /PID <è¿›ç¨‹ID> /F
```

### PowerShell vs CMD
- æ¨è PowerShell (åŠŸèƒ½æ›´å¼º)
- Git Bash ä¹Ÿå¾ˆå¥½ç”¨
- CMD å…¼å®¹æ€§æœ€å¥½

## å¸¸è§é—®é¢˜

### 1. 'psql' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤
**è§£å†³**: æ·»åŠ  PostgreSQL åˆ°ç¯å¢ƒå˜é‡

### 2. npm install å¤±è´¥
**è§£å†³**: 
```bash
npm cache clean --force
npm install
```

### 3. ç«¯å£è¢«å ç”¨
**è§£å†³**: ä¿®æ”¹ .env ä¸­çš„ PORT

### 4. æ•°æ®åº“è¿æ¥å¤±è´¥
**è§£å†³**: æ£€æŸ¥ .env ä¸­çš„ DB_PASSWORD

## å®ç”¨å·¥å…·

### æ¨èå®‰è£…
- VS Code - ä»£ç ç¼–è¾‘å™¨
- Git for Windows - ç‰ˆæœ¬æ§åˆ¶
- Postman - API æµ‹è¯•
- DBeaver - æ•°æ®åº“ç®¡ç†

### VS Code æ’ä»¶
- ESLint
- Prettier
- GitLens
- REST Client
- PostgreSQL